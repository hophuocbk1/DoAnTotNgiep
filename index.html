<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Máy Tính IP với Classful Subnetting</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #e9ecef;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            height: 100vh;
        }
        .container {
            display: flex;
            width: 100%;
            max-width: 1200px;
            background: #ffffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .guide {
            flex: 1;
            max-width: 300px;
            margin-right: 20px;
        }
        .guide h2 {
            color: #333;
            font-size: 20px;
            margin-bottom: 15px;
        }
        .guide p {
            font-size: 14px;
            color: #555;
            line-height: 1.6;
        }
        .guide strong {
            color: #d9534f;
        }
        .separator {
            width: 2px;
            background-color: #dee2e6;
            margin: 0 20px;
        }
        .form-container {
            flex: 2;
            width: 100%;
            display: flex;
            flex-direction: column;
        }
        h1 {
            color: #333;
            font-size: 24px;
            margin-bottom: 20px;
        }
        .oktett-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        .form-group {
            flex: 1 1 23%;
            box-sizing: border-box;
            margin-bottom: 10px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }
        .form-group input[type="text"],
        .form-group select {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            box-sizing: border-box;
            background-color: #f8f9fa;
        }
        .form-group input[type="text"]:focus,
        .form-group select:focus {
            border-color: #80bdff;
            outline: none;
            background-color: #ffffff;
        }
        .btn {
            padding: 12px;
            font-size: 16px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .footer-divider {
            width: 100%;
            height: 2px;
            background-color: #dee2e6;
            margin: 20px 0;
        }
        .footer {
            text-align: center;
            font-size: 16px;
            color: #333;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .footer p {
            margin: 10px 0;
        }
        .footer p:first-child {
            font-size: 18px;
            font-weight: bold;
            color: #007bff;
        }
        .footer a {
            color: #007bff;
            text-decoration: none;
        }
        .footer a:hover {
            text-decoration: underline;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #dee2e6;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f1f1f1;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Phần hướng dẫn sử dụng -->
        <div class="guide">
            <h2>Hướng dẫn sử dụng</h2>
            <p><strong>Bước 1:</strong> Nhập địa chỉ IP vào các trường Octet 1, Octet 2, Octet 3, và Octet 4. Đảm bảo rằng các giá trị nằm trong khoảng từ 0 đến 255.</p>
            <p><strong>Bước 2:</strong> Chọn lớp mạng phù hợp (Lớp A, B, hoặc C). Lớp mạng xác định cách subnet mask được thiết lập và số lượng mạng con có thể được tạo ra.</p>
            <p><strong>Bước 3:</strong> Nhập số mạng con bạn muốn chia. Số này phải là một số nguyên dương và không vượt quá giới hạn của lớp mạng đã chọn.</p>
            <p><strong>Bước 4:</strong> Nhấn nút "Tính" để tính toán. Chương trình sẽ hiển thị các thông tin liên quan đến mạng con bao gồm địa chỉ mạng, địa chỉ broadcast, phạm vi địa chỉ IP và số lượng IP hợp lệ cho từng mạng con.</p>
            <p><strong>Lưu ý:</strong> Nếu nhập sai dữ liệu hoặc dữ liệu không hợp lệ, bạn sẽ nhận được cảnh báo để chỉnh sửa trước khi thực hiện tính toán.</p>
        </div>

        <!-- Thanh chắn ngang giữa các phần -->
        <div class="separator"></div>

        <!-- Phần form tính toán -->
        <div class="form-container">
            <h1>Classful Subnetting Calculator</h1>
            <div class="oktett-container">
                <div class="form-group">
                    <label for="octet1">Octet 1:</label>
                    <input type="text" id="octet1" maxlength="3">
                </div>
                <div class="form-group">
                    <label for="octet2">Octet 2:</label>
                    <input type="text" id="octet2" maxlength="3">
                </div>
                <div class="form-group">
                    <label for="octet3">Octet 3:</label>
                    <input type="text" id="octet3" maxlength="3">
                </div>
                <div class="form-group">
                    <label for="octet4">Octet 4:</label>
                    <input type="text" id="octet4" maxlength="3">
                </div>
            </div>
            <div class="form-group">
                <label for="class">Lớp Mạng:</label>
                <select id="class">
                    <option value="A">Lớp A</option>
                    <option value="B">Lớp B</option>
                    <option value="C">Lớp C</option>
                </select>
            </div>
            <div class="form-group">
                <label for="subnetCount">Số Mạng Con:</label>
                <input type="text" id="subnetCount" maxlength="3">
            </div>
            <button class="btn" onclick="calculate()">Tính</button>

            <div class="footer-divider"></div>

            <!-- Kết quả tính toán -->
            <div id="results">
                <p class="result-label">Địa chỉ IP nhị phân: <span id="binaryIP"></span></p>
                <p class="result-label">Subnet Mask: <span id="subnetMask"></span></p>
                <p class="result-label">Subnet Mask nhị phân: <span id="binarySubnetMask"></span></p>
                <p class="result-label">Số Mạng Con: <span id="subnetCountResult"></span></p>

                <table>
                    <thead>
                        <tr>
                            <th>Mạng Con</th>
                            <th>Địa chỉ Mạng</th>
                            <th>Địa chỉ Broadcast</th>
                            <th>Phạm vi Địa chỉ IP</th>
                            <th>Số lượng IP hợp lệ</th>
                        </tr>
                    </thead>
                    <tbody id="subnetResults">
                        <!-- Kết quả mạng con sẽ được chèn vào đây -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>Đồ án tốt nghiệp - Hồ Trung Phước</p>
        <p>Ngày 20/08/2024</p>
        <p>Được phát triển bởi <a href="https://github.com/hophuocbk1" target="_blank">Hồ Trung Phước</a></p>
        <p>Vui lòng không Reup với mọi hình thức</p>
    </div>

    <script>
        function calculate() {
            const octet1 = parseInt(document.getElementById('octet1').value, 10);
            const octet2 = parseInt(document.getElementById('octet2').value, 10);
            const octet3 = parseInt(document.getElementById('octet3').value, 10);
            const octet4 = parseInt(document.getElementById('octet4').value, 10);
            const classType = document.getElementById('class').value;
            const subnetCount = parseInt(document.getElementById('subnetCount').value, 10);

            if (isNaN(octet1) || isNaN(octet2) || isNaN(octet3) || isNaN(octet4) || isNaN(subnetCount)) {
                alert('Vui lòng nhập đầy đủ và chính xác các trường dữ liệu!');
                return;
            }
            if (octet1 < 0 || octet1 > 255 || octet2 < 0 || octet2 > 255 || octet3 < 0 || octet3 > 255 || octet4 < 0 || octet4 > 255) {
                alert('Các giá trị octet phải nằm trong khoảng từ 0 đến 255!');
                return;
            }
            if (subnetCount < 1 || !Number.isInteger(subnetCount)) {
                alert('Số mạng con phải là một số nguyên dương!');
                return;
            }

            // Tính toán địa chỉ IP nhị phân
            const binaryIP = [octet1, octet2, octet3, octet4].map(num => num.toString(2).padStart(8, '0')).join('.');

            // Xác định subnet mask và số bit cho mạng con
            let subnetMask, subnetBits;
            switch (classType) {
                case 'A':
                    subnetMask = '255.0.0.0';
                    subnetBits = 8;
                    break;
                case 'B':
                    subnetMask = '255.255.0.0';
                    subnetBits = 16;
                    break;
                case 'C':
                    subnetMask = '255.255.255.0';
                    subnetBits = 24;
                    break;
                default:
                    alert('Lớp mạng không hợp lệ!');
                    return;
            }

            // Tính toán subnet mask nhị phân
            const binarySubnetMask = subnetMask.split('.').map(num => parseInt(num).toString(2).padStart(8, '0')).join('.');

            // Tính toán số bit cần thiết cho mạng con
            const requiredBits = Math.ceil(Math.log2(subnetCount));
            const totalBits = subnetBits + requiredBits;

            // Tính toán subnet mask mới và số mạng con
            const newSubnetMask = (0xFFFFFFFF << (32 - totalBits)) >>> 0;
            const newSubnetMaskStr = [
                (newSubnetMask >>> 24) & 0xFF,
                (newSubnetMask >>> 16) & 0xFF,
                (newSubnetMask >>> 8) & 0xFF,
                newSubnetMask & 0xFF
            ].join('.');

            // Tính toán các địa chỉ mạng và broadcast cho từng mạng con
            const networkAddresses = [];
            const broadcastAddresses = [];
            const ipRanges = [];
            const validIPCounts = [];

            for (let i = 0; i < subnetCount; i++) {
                const startAddress = (i * (1 << (32 - totalBits))) + (octet1 << 24) + (octet2 << 16) + (octet3 << 8) + octet4;
                const endAddress = startAddress + (1 << (32 - totalBits)) - 1;

                const networkAddress = [
                    (startAddress >>> 24) & 0xFF,
                    (startAddress >>> 16) & 0xFF,
                    (startAddress >>> 8) & 0xFF,
                    startAddress & 0xFF
                ].join('.');

                const broadcastAddress = [
                    (endAddress >>> 24) & 0xFF,
                    (endAddress >>> 16) & 0xFF,
                    (endAddress >>> 8) & 0xFF,
                    endAddress & 0xFF
                ].join('.');

                const firstIP = [
                    (startAddress >>> 24) & 0xFF,
                    (startAddress >>> 16) & 0xFF,
                    (startAddress >>> 8) & 0xFF,
                    (startAddress + 1) & 0xFF
                ].join('.');

                const lastIP = [
                    (endAddress >>> 24) & 0xFF,
                    (endAddress >>> 16) & 0xFF,
                    (endAddress >>> 8) & 0xFF,
                    (endAddress - 1) & 0xFF
                ].join('.');

                networkAddresses.push(networkAddress);
                broadcastAddresses.push(broadcastAddress);
                ipRanges.push(`${firstIP} - ${lastIP}`);
                validIPCounts.push((1 << (32 - totalBits)) - 2);
            }

            // Hiển thị kết quả
            document.getElementById('binaryIP').textContent = binaryIP;
            document.getElementById('subnetMask').textContent = newSubnetMaskStr;
            document.getElementById('binarySubnetMask').textContent = newSubnetMaskStr.split('.').map(num => parseInt(num).toString(2).padStart(8, '0')).join('.');
            document.getElementById('subnetCountResult').textContent = subnetCount;

            const subnetResults = document.getElementById('subnetResults');
            subnetResults.innerHTML = ''; // Xóa kết quả cũ

            for (let i = 0; i < subnetCount; i++) {
                const row = `<tr>
                    <td>Subnet ${i + 1}</td>
                    <td>${networkAddresses[i]}</td>
                    <td>${broadcastAddresses[i]}</td>
                    <td>${ipRanges[i]}</td>
                    <td>${validIPCounts[i]}</td>
                </tr>`;
                subnetResults.insertAdjacentHTML('beforeend', row);
            }
        }
    </script>
</body>
</html>
